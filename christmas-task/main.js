(()=>{"use strict";var t,e,n,s,i,r,o=function(){function t(){}return t.prototype.setElement=function(t){var e,n=t.tag,s=t.classList,i=void 0===s?void 0:s,r=t.innerText,o=void 0===r?void 0:r,a=t.attributes,l=void 0===a?void 0:a,c=document.createElement(n);return i&&(e=c.classList).add.apply(e,i),o&&(c.textContent=String(o)),l&&l.forEach((function(t){return c.setAttribute(t.name,t.value)})),c},t}();!function(t){t.white="#ffffff",t.yellow="#fdd700",t.red="#fd0000",t.blue="#2299eb",t.green="#08aa05"}(t||(t={})),function(t){t.sortByNameUp='По названию от "А" до "Я"',t.sortByNameDown='По названию от "Я" до "А"',t.sortByYearUp="По году от 1940 до 2020",t.sortByYearDown="По году от 2020 до 1940"}(e||(e={})),function(t){t.count="Количество",t.year="Год покупки",t.shape="Форма",t.color="Цвет",t.size="Размер",t.favorite="Любимая"}(n||(n={})),function(t){t["шар"]="ball",t["колокольчик"]="bell",t["шишка"]="cone",t["снежинка"]="snowflake",t["фигурка"]="toy"}(s||(s={})),function(t){t["белый"]="white",t["желтый"]="yellow",t["красный"]="red",t["синий"]="blue",t["зелёный"]="green"}(i||(i={})),function(t){t["большой"]="big",t["средний"]="medium",t["малый"]="small"}(r||(r={}));var a,l=function(t,e){return String(t.filter((function(t){return t[0]===e}))[0][1])},c=(a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(e){function n(t,n){var s=e.call(this)||this;return s.valueFilter=t,s.updateTrigger=n,s.sectionHTML=s.setElement({tag:"SECTION",classList:["value-filter"]}),s}return c(n,e),n.prototype.update=function(){var e=this,n=Object.entries(this.valueFilter.choosedForms),s=Object.entries(this.valueFilter.choosedColors),i=Object.entries(this.valueFilter.choosedSizes),r=this.setElement({tag:"H2",classList:["value-title"],innerText:"фильтры по значению"}),o=this.setElement({tag:"UL",classList:["value-list"]}),a=this.setElement({tag:"LI",classList:["value-item"]}),c=this.setElement({tag:"H3",classList:["toyform-subtitle"],innerText:"Форма:"}),u=this.setElement({tag:"UL",classList:["toyform-list"]}),p=new Array(Object.keys(this.valueFilter.choosedForms).length).fill(null).map((function(t,s){var i=e.setElement({tag:"LI",classList:["toyform-item"]}),r=n[s][0];return e.valueFilter.choosedForms[r]&&i.classList.add("active"),i.setAttribute("style","background-image: url(../../assets/svg/".concat(r,".svg);")),i.onclick=function(){var t=e.valueFilter.choosedForms[r];e.valueFilter.choosedForms[r]=!t,i.classList.toggle("active"),e.updateTrigger()},i}));a.append(c,u),u.append.apply(u,p);var g=this.setElement({tag:"LI",classList:["value-item"]}),h=this.setElement({tag:"H3",classList:["color-subtitle"],innerText:"Цвет:"}),y=this.setElement({tag:"UL",classList:["color-list"]}),d=new Array(Object.keys(this.valueFilter.choosedColors).length).fill(null).map((function(n,i){var r=s[i][0],o=e.setElement({tag:"LI",classList:["color-item"],attributes:[{name:"style",value:"background-color:".concat(l(Object.entries(t),r))}]});return e.valueFilter.choosedColors[r]&&o.classList.add("active"),o.onclick=function(){var t=e.valueFilter.choosedColors[r];e.valueFilter.choosedColors[r]=!t,o.classList.toggle("active"),e.updateTrigger()},o}));g.append(h,y),y.append.apply(y,d);var f=["big","medium","small"],v=this.setElement({tag:"LI",classList:["value-item"]}),m=this.setElement({tag:"H3",classList:["size-subtitle"],innerText:"Размер:"}),L=this.setElement({tag:"UL",classList:["size-list"]}),b=new Array(Object.keys(this.valueFilter.choosedSizes).length).fill(null).map((function(t,n){var s=e.setElement({tag:"LI",classList:["size-item",f[n]]}),r=i[n][0];return e.valueFilter.choosedSizes[r]&&s.classList.add("active"),s.onclick=function(){var t=e.valueFilter.choosedSizes[r];e.valueFilter.choosedSizes[r]=!t,s.classList.toggle("active"),e.updateTrigger()},s}));v.append(m,L),L.append.apply(L,b);var S=this.setElement({tag:"LI",classList:["value-item"]}),E=this.setElement({tag:"H3",classList:["favorites-subtitle"],innerText:"Только любимые"}),T=this.setElement({tag:"DIV",classList:["favorites-checkbox"]});this.valueFilter.onlyFavorites&&T.classList.add("active"),T.onclick=function(){var t=e.valueFilter.onlyFavorites;e.valueFilter.onlyFavorites=!t,T.classList.toggle("active"),e.updateTrigger()},S.append(E,T),o.append(a,g,v,S),this.sectionHTML.innerHTML="",this.sectionHTML.append(r,o)},n}(o),p=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),g=function(t){function e(e,n){var s=t.call(this)||this;return s.parentSettings=e,s.updateTrigger=n,s.sectionHTML=s.setElement({tag:"SECTION",classList:["range-section"]}),s}return p(e,t),e.prototype.update=function(){var t=this,e=this.setElement({tag:"H2",classList:["range-title"],innerText:"фильтры по диапазону"}),n=this.setElement({tag:"DIV",classList:["range-container"]}),s=this.setElement({tag:"DIV",classList:["count-container"]}),i=this.setElement({tag:"H3",classList:["count-subtitle"],innerText:"Количество экземпляров"}),r=this.setElement({tag:"DIV",classList:["count-label"]}),o=this.setElement({tag:"SPAN",classList:["count-min"],innerText:String(1)}),a=this.setElement({tag:"INPUT",classList:["count-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1)},{name:"max",value:String(12)},{name:"step",value:String(1)},{name:"value",value:String(this.parentSettings.countRange[1])}]});a.onchange=function(e){t.parentSettings.countRange[1]=Number(e.target.value),t.updateTrigger()};var l=this.setElement({tag:"SPAN",classList:["count-max"],innerText:String(12)});s.append(i,r),r.append(o,a,l);var c=this.setElement({tag:"DIV",classList:["year-container"]}),u=this.setElement({tag:"H3",classList:["year-subtitle"],innerText:"Год приобретения:"}),p=this.setElement({tag:"DIV",classList:["year-label"]}),g=this.setElement({tag:"SPAN",classList:["year-min"],innerText:String(1940)}),h=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1940)},{name:"max",value:String(2020)},{name:"step",value:String(10)},{name:"value",value:String(this.parentSettings.yearRange[1])}]});h.onchange=function(e){t.parentSettings.yearRange[1]=Number(e.target.value),t.updateTrigger()};var y=this.setElement({tag:"SPAN",classList:["year-max"],innerText:String(2020)});c.append(u,p),p.append(g,h,y),n.append(s,c),this.sectionHTML.innerHTML="",this.sectionHTML.append(e,n)},e}(o),h=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),y=function(t){function e(e,n,s){var i=t.call(this)||this;return i.toysList=e,i.toysContainer=i.setElement({tag:"SECTION",classList:["toys"]}),i.toysIdList=n,i.triggerUpdateIdList=s,i}return h(e,t),e.prototype.update=function(t,e){var o,a=this,c=function(t){return Boolean(Object.values(t).includes(!0))},u=Object.entries(n),p=function(t,e,n){if(n||2===arguments.length)for(var s,i=0,r=e.length;i<r;i++)!s&&i in e||(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}([],this.toysList,!0);p=(p=(p=p.filter((function(e){if(c(t.valueFilters.choosedForms)){var n=Object.entries(t.valueFilters.choosedForms).filter((function(t){return t[1]})),i=l(Object.entries(s),e.shape);return Boolean(n.find((function(t){return t[0]===i})))}return!0}))).filter((function(e){if(c(t.valueFilters.choosedColors)){var n=Object.entries(t.valueFilters.choosedColors).filter((function(t){return t[1]})),s=l(Object.entries(i),e.color);return Boolean(n.find((function(t){return t[0]===s})))}return!0}))).filter((function(e){if(c(t.valueFilters.choosedSizes)){var n=Object.entries(t.valueFilters.choosedSizes).filter((function(t){return t[1]})),s=l(Object.entries(r),e.size);return Boolean(n.find((function(t){return t[0]===s})))}return!0})),t.valueFilters.onlyFavorites&&(p=p.filter((function(t){return t.favorite}))),(p=p.filter((function(e){return[[t.rangeFilters.countRange[0],+e.count,t.rangeFilters.countRange[1]],[t.rangeFilters.yearRange[0],+e.year,t.rangeFilters.yearRange[1]]].every((function(t){return t.every((function(e,n){return!(n<t.length-1)||e<=t[n+1]}))}))}))).sort((function(e,n){switch(t.choosedSortKey){case"sortByNameUp":return e.name<n.name?-1:1;case"sortByNameDown":return e.name>n.name?-1:1;case"sortByYearUp":return Number(e.year)-Number(n.year);case"sortByYearDown":return Number(n.year)-Number(e.year)}}));var g=(p=p.filter((function(t){var n=e.toUpperCase();return t.name.toUpperCase().includes(n)}))).map((function(t){var e="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/toys/".concat(t.num,".avif"),n=a.setElement({tag:"DIV",classList:["toy"]});a.toysIdList.includes(Number(t.num))&&n.classList.add("active"),n.onclick=function(){var e=Number(t.num);if(a.toysIdList.includes(e)){var s=a.toysIdList.indexOf(e);a.toysIdList.splice(s,1)}else a.toysIdList.push(e);n.classList.toggle("active"),a.triggerUpdateIdList()};var s=a.setElement({tag:"H3",classList:["toy-title"],innerText:t.name}),i=a.setElement({tag:"DIV",classList:["toy-content"]}),r=a.setElement({tag:"DIV",classList:["img-container"]}),o=a.setElement({tag:"IMG",classList:["toy-image"],attributes:[{name:"src",value:e},{name:"alt",value:t.name}]}),l=a.setElement({tag:"BUTTON",classList:["toy-favorite"]}),c=a.setElement({tag:"UL",classList:["description-list"]}),p=new Array(u.length).fill(0).map((function(e,n){var s=u[n][0],i=t[s],r=u[n][1]+": "+("boolean"!=typeof i?String(i):i?"да":"нет");return a.setElement({tag:"LI",classList:["description-item"],innerText:r})}));return n.append(s,i),i.append(r,c),r.append(o,l),c.append.apply(c,p),n}));this.toysContainer.innerHTML="",(o=this.toysContainer).append.apply(o,g)},e.prototype.build=function(){var t=this.setElement({tag:"SECTION",classList:["toys-container"]});return t.append(this.toysContainer),t},e}(o),d=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),f=function(t){function n(e,n,s){var i=t.call(this)||this;return i.parentSettings=e,i.updateTrigger=n,i.resetTrigger=s,i}return d(n,t),n.prototype.build=function(){var t=this,n=Object.entries(e),s=this.setElement({tag:"SECTION",classList:["sort-section"]}),i=this.setElement({tag:"H2",classList:["sort-title"],innerText:"Сортировка:"}),r=this.setElement({tag:"DIV",classList:["sort-container"]}),o=this.setElement({tag:"SELECT",classList:["sort-select"],attributes:[{name:"name",value:"sort"}]});o.onchange=function(e){t.parentSettings.choosedSortKey=e.target.value,t.updateTrigger()};var a=new Array(n.length).fill(0).map((function(e,s){var i=t.setElement({tag:"OPTION",classList:["sort-option"],innerText:n[s][1],attributes:[{name:"value",value:n[s][0]}]});return n[s][0]===t.parentSettings.choosedSortKey&&i.setAttribute("selected","selected"),i})),l=this.setElement({tag:"BUTTON",classList:["reset-button"],innerText:"Сброс фильтров"});return l.onclick=function(){t.resetTrigger()},s.append(i,r),r.append(o,l),o.append.apply(o,a),s},n}(o),v=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),m=function(t){function e(e,n){var s=t.call(this)||this;return s.toysSettings=n,s.searchValue="",s.valueFilterSection=new u(s.toysSettings.valueFilters,s.updateToys.bind(s)),s.rangeFilterSection=new g(s.toysSettings.rangeFilters,s.updateToys.bind(s)),s.sortSection=new f(s.toysSettings,s.updateToys.bind(s),s.resetSettings.bind(s)),s.toysSection=new y(e,s.toysSettings.choosedIdList,s.updateChoosedIdList.bind(s)),s.choosedToysDisplay=s.setElement({tag:"DIV",classList:["search-found"]}),s}return v(e,t),Object.defineProperty(e.prototype,"selectedToysCount",{get:function(){return String(this.toysSettings.choosedIdList.length)},enumerable:!1,configurable:!0}),e.prototype.draw=function(){var t=this,e=this.setElement({tag:"HEADER",classList:["header"]}),n=this.setElement({tag:"UL",classList:["nav-list"]}),s=[void 0,"игрушки","ёлка"].map((function(e,n){var s=t.setElement({tag:"LI",classList:["nav-item"]}),i=n?["nav-button"]:["nav-button","icon"],r=t.setElement({tag:"BUTTON",classList:i,innerText:e});return s.append(r),s})),i=this.setElement({tag:"DIV",classList:["search-container"]}),r=this.setElement({tag:"BUTTON",classList:["reset-input-button"]}),o=this.setElement({tag:"DIV",classList:["search-input-wrapper"]}),a=this.setElement({tag:"INPUT",classList:["search-input"],innerText:null,attributes:[{name:"type",value:"text"},{name:"placeholder",value:"Поиск"}]});a.oninput=function(e){t.searchValue=e.target.value,t.updateToys()},r.onclick=function(){a.value="",t.searchValue="",t.updateToys()},this.updateChoosedIdList(),e.append(n,i),n.append.apply(n,s),i.append(r,o,this.choosedToysDisplay),o.append(a);var l=this.setElement({tag:"MAIN",classList:["toys-section"]}),c=this.setElement({tag:"FOOTER",classList:["footer"]}),u=this.setElement({tag:"A",classList:["rss-logo"],attributes:[{name:"href",value:"https://rs.school/"}]}),p=this.setElement({tag:"DIV",classList:["author-container"]}),g=this.setElement({tag:"SPAN",innerText:"App Developer: IX/CptShell"}),h=this.setElement({tag:"SPAN",innerText:"2021"});c.append(u,p),p.append(g,h),this.valueFilterSection.update(),this.rangeFilterSection.update();var y=this.sortSection.build(),d=this.toysSection.build();this.updateToys(),l.append(this.valueFilterSection.sectionHTML,this.rangeFilterSection.sectionHTML,y,d),document.body.append(e,l,c),window.onbeforeunload=function(){return localStorage.setItem("userToysSettings",JSON.stringify(t.toysSettings))}},e.prototype.updateChoosedIdList=function(){this.choosedToysDisplay.textContent=this.selectedToysCount},e.prototype.updateToys=function(){this.toysSection.update(this.toysSettings,this.searchValue)},e.prototype.resetSettings=function(){var t=this;Object.keys(this.toysSettings.valueFilters.choosedForms).forEach((function(e){t.toysSettings.valueFilters.choosedForms[e]=!1})),Object.keys(this.toysSettings.valueFilters.choosedColors).forEach((function(e){t.toysSettings.valueFilters.choosedColors[e]=!1})),Object.keys(this.toysSettings.valueFilters.choosedSizes).forEach((function(e){t.toysSettings.valueFilters.choosedSizes[e]=!1})),this.toysSettings.valueFilters.onlyFavorites=!1,this.toysSettings.rangeFilters.countRange=[0,12],this.toysSettings.rangeFilters.yearRange=[1940,2020],this.valueFilterSection.update(),this.rangeFilterSection.update(),this.updateToys()},e}(o);const L={valueFilters:{choosedForms:{ball:!1,bell:!1,cone:!1,snowflake:!1,toy:!1},choosedColors:{white:!1,yellow:!1,red:!1,blue:!1,green:!1},choosedSizes:{big:!1,medium:!1,small:!1},onlyFavorites:!1},rangeFilters:{countRange:[0,12],yearRange:[1940,2020]},choosedSortKey:"sortByNameUp",choosedIdList:[]};var b=function(){function t(t){var e=JSON.parse(localStorage.getItem("userToysSettings"))||L;this.toys=new m(t,e)}return t.prototype.init=function(){this.toys.draw()},t}();fetch("https://raw.githubusercontent.com/cptShell/christmas-data/main/data.json").then((function(t){return t.json()})).then((function(t){new b(t).init()}))})();
//# sourceMappingURL=main.js.map