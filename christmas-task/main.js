(()=>{"use strict";var t,e,n,a,s,r,o=function(){function t(){}return t.prototype.setElement=function(t){var e,n=t.tag,a=t.classList,s=void 0===a?void 0:a,r=t.innerText,o=void 0===r?void 0:r,i=t.attributes,l=void 0===i?void 0:i,c=document.createElement(n);return s&&(e=c.classList).add.apply(e,s),o&&(c.textContent=String(o)),l&&l.forEach((function(t){return c.setAttribute(t.name,t.value)})),c},t}(),i={multicolor:"linear-gradient(\n    124deg, #ff2400, #e81d1d, #e8b71d, #e3e81d, #1de840, #1ddde8, #2b1de8)",red:"#F00",blue:"#24E0FF",yellow:"#FF0",green:"#ABFF00"};!function(t){t.white="#ffffff",t.yellow="#fdd700",t.red="#fd0000",t.blue="#2299eb",t.green="#08aa05"}(t||(t={})),function(t){t.sortByNameUp='По названию от "А" до "Я"',t.sortByNameDown='По названию от "Я" до "А"',t.sortByYearUp="По году от 1940 до 2020",t.sortByYearDown="По году от 2020 до 1940"}(e||(e={})),function(t){t.count="Количество",t.year="Год покупки",t.shape="Форма",t.color="Цвет",t.size="Размер",t.favorite="Любимая"}(n||(n={})),function(t){t["шар"]="ball",t["колокольчик"]="bell",t["шишка"]="cone",t["снежинка"]="snowflake",t["фигурка"]="toy"}(a||(a={})),function(t){t["белый"]="white",t["желтый"]="yellow",t["красный"]="red",t["синий"]="blue",t["зелёный"]="green"}(s||(s={})),function(t){t["большой"]="big",t["средний"]="medium",t["малый"]="small"}(r||(r={}));var l,c=function(t,e){return String(t.filter((function(t){return t[0]===e}))[0][1])},u=function(t){return new Promise((function(e){var n=new Image;n.onload=function(){n.onload=null,e(t)},n.src=t}))},p=function(t,e){t.classList.toggle("active",e),t.textContent=e?"On":"Off"},g=function(t,e,n,a,s){t.style.left=Number(e)-Number(a||60)/2+"px",t.style.top=Number(n)-Number(s||60)/2+"px"},d=(l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},l(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(e){function n(t,n){var a=e.call(this)||this;return a.valueFilter=t,a.updateTrigger=n,a.sectionHTML=a.setElement({tag:"SECTION",classList:["value-filter"]}),a}return d(n,e),n.prototype.update=function(){var e=this,n=Object.entries(this.valueFilter.choosedForms),a=Object.entries(this.valueFilter.choosedColors),s=Object.entries(this.valueFilter.choosedSizes),r=this.setElement({tag:"H2",classList:["value-title"],innerText:"фильтры по значению"}),o=this.setElement({tag:"UL",classList:["value-list"]}),i=this.setElement({tag:"LI",classList:["value-item"]}),l=this.setElement({tag:"H3",classList:["toyform-subtitle"],innerText:"Форма:"}),u=this.setElement({tag:"UL",classList:["toyform-list"]}),p=new Array(Object.keys(this.valueFilter.choosedForms).length).fill(null).map((function(t,a){var s=n[a][0],r=e.setElement({tag:"LI",classList:["toyform-item","toyform-"+s]});return e.valueFilter.choosedForms[s]&&r.classList.add("active"),r.onclick=function(){var t=e.valueFilter.choosedForms[s];e.valueFilter.choosedForms[s]=!t,r.classList.toggle("active"),e.updateTrigger()},r}));i.append(l,u),u.append.apply(u,p);var g=this.setElement({tag:"LI",classList:["value-item"]}),d=this.setElement({tag:"H3",classList:["color-subtitle"],innerText:"Цвет:"}),f=this.setElement({tag:"UL",classList:["color-list"]}),y=new Array(Object.keys(this.valueFilter.choosedColors).length).fill(null).map((function(n,s){var r=a[s][0],o=e.setElement({tag:"LI",classList:["color-item"],attributes:[{name:"style",value:"background-color:".concat(c(Object.entries(t),r))}]});return e.valueFilter.choosedColors[r]&&o.classList.add("active"),o.onclick=function(){var t=e.valueFilter.choosedColors[r];e.valueFilter.choosedColors[r]=!t,o.classList.toggle("active"),e.updateTrigger()},o}));g.append(d,f),f.append.apply(f,y);var m=["big","medium","small"],h=this.setElement({tag:"LI",classList:["value-item"]}),v=this.setElement({tag:"H3",classList:["size-subtitle"],innerText:"Размер:"}),S=this.setElement({tag:"UL",classList:["size-list"]}),L=new Array(Object.keys(this.valueFilter.choosedSizes).length).fill(null).map((function(t,n){var a=e.setElement({tag:"LI",classList:["size-item",m[n]]}),r=s[n][0];return e.valueFilter.choosedSizes[r]&&a.classList.add("active"),a.onclick=function(){var t=e.valueFilter.choosedSizes[r];e.valueFilter.choosedSizes[r]=!t,a.classList.toggle("active"),e.updateTrigger()},a}));h.append(v,S),S.append.apply(S,L);var T=this.setElement({tag:"LI",classList:["value-item"]}),x=this.setElement({tag:"H3",classList:["favorites-subtitle"],innerText:"Только любимые"}),b=this.setElement({tag:"DIV",classList:["favorites-checkbox"]});this.valueFilter.onlyFavorites&&b.classList.add("active"),b.onclick=function(){var t=e.valueFilter.onlyFavorites;e.valueFilter.onlyFavorites=!t,b.classList.toggle("active"),e.updateTrigger()},T.append(x,b),o.append(i,g,h,T),this.sectionHTML.innerHTML="",this.sectionHTML.append(r,o)},n}(o),y=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),m=function(t){function e(e,n){var a=t.call(this)||this;return a.parentSettings=e,a.updateTrigger=n,a.sectionHTML=a.setElement({tag:"SECTION",classList:["range-section"]}),a}return y(e,t),e.prototype.update=function(){var t=this,e=this.setElement({tag:"H2",classList:["range-title"],innerText:"фильтры по диапазону"}),n=this.setElement({tag:"DIV",classList:["range-container"]}),a=this.setElement({tag:"DIV",classList:["count-container"]}),s=this.setElement({tag:"H3",classList:["count-subtitle"],innerText:"Количество экземпляров"}),r=this.setElement({tag:"DIV",classList:["count-label"]}),o=this.setElement({tag:"SPAN",classList:["count-min"],innerText:String(this.parentSettings.countRange[0])}),i=this.setElement({tag:"SPAN",classList:["count-max"],innerText:String(this.parentSettings.countRange[1])}),l=this.setElement({tag:"DIV",classList:["count-input-container"]}),c=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1)},{name:"max",value:String(12)},{name:"step",value:String(1)},{name:"value",value:String(this.parentSettings.countRange[0])}]}),u=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1)},{name:"max",value:String(12)},{name:"step",value:String(1)},{name:"value",value:String(this.parentSettings.countRange[1])}]});c.addEventListener("input",(function(){+c.value>+u.value&&(u.value=c.value),t.parentSettings.countRange[0]=Number(c.value),t.parentSettings.countRange[1]=Number(u.value),o.textContent=String(t.parentSettings.countRange[0]),i.textContent=String(t.parentSettings.countRange[1])})),u.addEventListener("input",(function(){+u.value<+c.value&&(c.value=u.value),t.parentSettings.countRange[0]=Number(c.value),t.parentSettings.countRange[1]=Number(u.value),o.textContent=String(t.parentSettings.countRange[0]),i.textContent=String(t.parentSettings.countRange[1])})),l.append(c,u),a.append(s,r),r.append(o,l,i);var p=this.setElement({tag:"DIV",classList:["year-container"]}),g=this.setElement({tag:"H3",classList:["year-subtitle"],innerText:"Год приобретения:"}),d=this.setElement({tag:"DIV",classList:["year-label"]}),f=this.setElement({tag:"SPAN",classList:["year-min"],innerText:String(this.parentSettings.yearRange[0])}),y=this.setElement({tag:"SPAN",classList:["year-max"],innerText:String(this.parentSettings.yearRange[1])}),m=this.setElement({tag:"DIV",classList:["year-input-container"]}),h=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1940)},{name:"max",value:String(2020)},{name:"step",value:String(10)},{name:"value",value:String(this.parentSettings.yearRange[0])}]}),v=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1940)},{name:"max",value:String(2020)},{name:"step",value:String(10)},{name:"value",value:String(this.parentSettings.yearRange[1])}]});h.addEventListener("input",(function(){+h.value>+v.value&&(v.value=h.value),t.parentSettings.yearRange[0]=Number(h.value),t.parentSettings.yearRange[1]=Number(v.value),f.textContent=String(t.parentSettings.yearRange[0]),y.textContent=String(t.parentSettings.yearRange[1])})),v.addEventListener("input",(function(){+v.value<+h.value&&(h.value=v.value),t.parentSettings.yearRange[0]=Number(h.value),t.parentSettings.yearRange[1]=Number(v.value),f.textContent=String(t.parentSettings.yearRange[0]),y.textContent=String(t.parentSettings.yearRange[1])})),[h,v,c,u].forEach((function(e){return e.onchange=function(){return t.updateTrigger()}})),m.append(h,v),p.append(g,d),d.append(f,m,y),n.append(a,p),this.sectionHTML.innerHTML="",this.sectionHTML.append(e,n)},e}(o),h=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=function(t){function e(){var e=t.call(this)||this;return e.wrapper=e.setElement({tag:"DIV",classList:["popup-wrapper"]}),e.element=e.setElement({tag:"DIV",classList:["popup"]}),e.wrapper.append(e.element),e.isActive=!1,e}return h(e,t),e.prototype.draw=function(t){var e=this;this.isActive||(this.isActive=!0,this.element.textContent=t,document.body.append(this.wrapper),this.wrapper.animate([{opacity:0},{opacity:1}],{duration:250,easing:"ease"}).onfinish=function(){e.wrapper.classList.add("active"),e.element.animate([{transform:"translateY(-200px)",opacity:0},{transform:"translateY(0)",opacity:1}],{duration:250,easing:"ease"}).onfinish=function(){e.element.classList.add("active"),e.wrapper.onclick=function(){e.destroy(),e.wrapper.onclick=null},document.onkeyup=function(t){13===t.keyCode&&e.destroy(),document.onkeyup=null}}})},e.prototype.destroy=function(){var t=this;this.element.animate([{transform:"translateY(0)",opacity:1},{transform:"translateY(-200px)",opacity:0}],{duration:250,easing:"ease"}).onfinish=function(){t.element.classList.remove("active"),t.wrapper.animate([{opacity:1},{opacity:0}],{duration:250,easing:"ease"}).onfinish=function(){t.element.classList.remove("active"),t.wrapper.remove(),t.isActive=!1}}},e}(o),S=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),L=function(t){function e(e,n,a,s){var r=t.call(this)||this;return r.toysList=e,r.toysContainer=r.setElement({tag:"SECTION",classList:["toys"]}),r.toysIdList=n,r.triggerUpdateIdList=a,r.triggerSaveState=s,r.popup=new v,r}return S(e,t),e.prototype.update=function(t,e,o){var i,l=this;void 0===o&&(o=!1);var u=function(t){return Boolean(Object.values(t).includes(!0))},p=Object.entries(n),g=function(t,e,n){if(n||2===arguments.length)for(var a,s=0,r=e.length;s<r;s++)!a&&s in e||(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return t.concat(a||Array.prototype.slice.call(e))}([],this.toysList,!0);g=(g=(g=g.filter((function(e){if(u(t.valueFilters.choosedForms)){var n=Object.entries(t.valueFilters.choosedForms).filter((function(t){return t[1]})),s=c(Object.entries(a),e.shape);return Boolean(n.find((function(t){return t[0]===s})))}return!0}))).filter((function(e){if(u(t.valueFilters.choosedColors)){var n=Object.entries(t.valueFilters.choosedColors).filter((function(t){return t[1]})),a=c(Object.entries(s),e.color);return Boolean(n.find((function(t){return t[0]===a})))}return!0}))).filter((function(e){if(u(t.valueFilters.choosedSizes)){var n=Object.entries(t.valueFilters.choosedSizes).filter((function(t){return t[1]})),a=c(Object.entries(r),e.size);return Boolean(n.find((function(t){return t[0]===a})))}return!0})),t.valueFilters.onlyFavorites&&(g=g.filter((function(t){return t.favorite}))),(g=g.filter((function(e){return[[t.rangeFilters.countRange[0],+e.count,t.rangeFilters.countRange[1]],[t.rangeFilters.yearRange[0],+e.year,t.rangeFilters.yearRange[1]]].every((function(t){return t.every((function(e,n){return!(n<t.length-1)||e<=t[n+1]}))}))}))).sort((function(e,n){switch(t.choosedSortKey){case"sortByNameUp":return e.name<n.name?-1:1;case"sortByNameDown":return e.name>n.name?-1:1;case"sortByYearUp":return Number(e.year)-Number(n.year);case"sortByYearDown":return Number(n.year)-Number(e.year)}}));var d=(g=g.filter((function(t){var n=e.toUpperCase();return t.name.toUpperCase().includes(n)}))).map((function(t){var e="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/toys/".concat(t.num,".avif"),n=l.setElement({tag:"DIV",classList:["toy"]});l.toysIdList.includes(Number(t.num))&&n.classList.add("active"),n.onclick=function(){var e=Number(t.num);if(l.toysIdList.includes(e)){var a=l.toysIdList.indexOf(e);l.toysIdList.splice(a,1)}else{if(l.toysIdList.length>=20)return void l.popup.draw("Вы не можете выбрать более 20 игрушек!!!");l.toysIdList.push(e)}n.classList.toggle("active"),l.triggerUpdateIdList()};var a=l.setElement({tag:"H3",classList:["toy-title"],innerText:t.name}),s=l.setElement({tag:"DIV",classList:["toy-content"]}),r=l.setElement({tag:"DIV",classList:["img-container"]}),o=l.setElement({tag:"IMG",classList:["toy-image"],attributes:[{name:"src",value:e},{name:"alt",value:t.name}]}),i=l.setElement({tag:"BUTTON",classList:["toy-favorite"]}),c=l.setElement({tag:"UL",classList:["description-list"]}),u=new Array(p.length).fill(0).map((function(e,n){var a=p[n][0],s=t[a],r=p[n][1]+": "+("boolean"!=typeof s?String(s):s?"да":"нет");return l.setElement({tag:"LI",classList:["description-item"],innerText:r})}));return n.append(a,s),s.append(r,c),r.append(o,i),c.append.apply(c,u),n}));o&&!d.length?this.popup.draw("Не найдено ни одного совпадения по введенным данным среди отфильтрованных игрушек!!!"):(this.toysContainer.innerHTML="",(i=this.toysContainer).append.apply(i,d)),this.triggerSaveState(!0)},e.prototype.build=function(){var t=this.setElement({tag:"SECTION",classList:["toys-container"]});return t.append(this.toysContainer),t},e}(o),T=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),x=function(t){function n(e,n,a,s){var r=t.call(this)||this;return r.parentSettings=e,r.updateTrigger=n,r.resetFilterTrigger=a,r.resetLocalStorageTrigger=s,r}return T(n,t),n.prototype.build=function(){var t=this,n=Object.entries(e),a=this.setElement({tag:"SECTION",classList:["sort-section"]}),s=this.setElement({tag:"H2",classList:["sort-title"],innerText:"Сортировка:"}),r=this.setElement({tag:"DIV",classList:["sort-container"]}),o=this.setElement({tag:"SELECT",classList:["sort-select"],attributes:[{name:"name",value:"sort"}]});o.onchange=function(e){t.parentSettings.choosedSortKey=e.target.value,t.updateTrigger()};var i=new Array(n.length).fill(0).map((function(e,a){var s=t.setElement({tag:"OPTION",classList:["sort-option"],innerText:n[a][1],attributes:[{name:"value",value:n[a][0]}]});return n[a][0]===t.parentSettings.choosedSortKey&&s.setAttribute("selected","selected"),s})),l=this.setElement({tag:"DIV",classList:["reset-controls"]}),c=this.setElement({tag:"BUTTON",classList:["reset-button"],innerText:"Cброс настроек"}),u=this.setElement({tag:"BUTTON",classList:["reset-button"],innerText:"Сброс фильтров"});return c.onclick=function(){t.resetLocalStorageTrigger()},u.onclick=function(){t.resetFilterTrigger()},a.append(s,r),r.append(o,l),l.append(c,u),o.append.apply(o,i),a},n}(o),b={valueFilters:{choosedForms:{ball:!1,bell:!1,cone:!1,snowflake:!1,toy:!1},choosedColors:{white:!1,yellow:!1,red:!1,blue:!1,green:!1},choosedSizes:{big:!1,medium:!1,small:!1},onlyFavorites:!1},rangeFilters:{countRange:[0,12],yearRange:[1940,2020]},choosedSortKey:"sortByNameUp",choosedIdList:[]},E={bgNum:1,treeNum:1,volume:!1,snowfall:!1,garland:{isActive:!1,color:"red"}},w=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),O=function(t,e,n){if(n||2===arguments.length)for(var a,s=0,r=e.length;s<r;s++)!a&&s in e||(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return t.concat(a||Array.prototype.slice.call(e))},I=function(t){function e(e,n,a,s,r,o){var i=t.call(this)||this;return i.pageSettings=e,i.sectionHTML=i.setElement({tag:"SECTION",classList:["settings-section"]}),i.triggerUpdateTree=function(t){return n(t)},i.triggerMusic=a,i.triggerSnowfall=s,i.triggerSaveSettings=r,i.popup=o,i}return w(e,t),e.prototype.update=function(){return t=this,e=void 0,a=function(){var t,e,n,a,s,r,o,l,c,g,d,f,y,m,h,v,S,L,T,x=this;return function(t,e){var n,a,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&r[0]?a.return:r[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,r[1])).done)return s;switch(a=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],a=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}}(this,(function(b){switch(b.label){case 0:return this.sectionHTML.innerHTML="",t=this.setElement({tag:"DIV",classList:["controls-container"]}),e=this.setElement({tag:"BUTTON",classList:["volume-button"]}),this.pageSettings.volume&&e.classList.add("active"),e.onclick=function(){x.pageSettings.volume=!x.pageSettings.volume,e.classList.toggle("active",x.pageSettings.volume),x.triggerMusic(),x.triggerSaveSettings()},n=this.setElement({tag:"BUTTON",classList:["snow-button"]}),this.pageSettings.snowfall&&n.classList.add("active"),n.onclick=function(){x.pageSettings.snowfall=!x.pageSettings.snowfall,n.classList.toggle("active",x.pageSettings.snowfall),x.triggerSnowfall(),x.triggerSaveSettings()},[4,u("https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/svg/audio.svg")];case 1:return a=b.sent(),[4,u("https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/svg/snow.svg")];case 2:return s=b.sent(),e.setAttribute("style","background-image: url(".concat(a,")")),n.setAttribute("style","background-image: url(".concat(s,")")),t.append(e,n),r=this.setElement({tag:"DIV",classList:["choose-tree-container"]}),o=this.setElement({tag:"H2",classList:["choose-tree-title"]}),l=this.setElement({tag:"UL",classList:["choose-tree-list"]}),c=new Array(6).fill(0).map((function(t,e){var n=x.setElement({tag:"LI",classList:["choose-tree-item"]});e+1===x.pageSettings.treeNum&&n.classList.add("active");var a=new Image,s="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/tree/".concat(e+1,".avif");return a.onload=function(){n.style.backgroundImage="url(".concat(s,")")},a.src=s,n.onclick=function(){x.pageSettings.treeNum=e+1,c.forEach((function(t,n){return t.classList.toggle("active",e===n)})),x.triggerUpdateTree("updateTree"),x.triggerSaveSettings()},n})),r.append(o,l),l.append.apply(l,c),g=this.setElement({tag:"DIV",classList:["bg-container"]}),d=this.setElement({tag:"H2",classList:["bg-title"],innerText:"выберите фон"}),f=this.setElement({tag:"UL",classList:["bg-list"]}),y=new Array(10).fill(0).map((function(t,e){var n=x.setElement({tag:"LI",classList:["bg-item"]});e+1===x.pageSettings.bgNum&&n.classList.add("active");var a=new Image,s="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/bg/".concat(e+1,".avif");return a.onload=function(){n.style.backgroundImage="url(".concat(s,")")},a.src=s,n.onclick=function(){x.pageSettings.bgNum=e+1,y.forEach((function(t,n){return t.classList.toggle("active",n===e)})),x.triggerUpdateTree("updateBg"),x.triggerSaveSettings()},n})),g.append(d,f),f.append.apply(f,y),m=this.setElement({tag:"DIV",classList:["garland-container"]}),h=this.setElement({tag:"H2",classList:["garland-title"],innerText:"гирлянда"}),v=this.setElement({tag:"UL",classList:["garland-list"]}),S=this.setElement({tag:"BUTTON",classList:["garland-toggler"]}),p(S,this.pageSettings.garland.isActive),S.onclick=function(){x.pageSettings.garland.isActive=!x.pageSettings.garland.isActive,p(S,x.pageSettings.garland.isActive),x.triggerUpdateTree(),x.triggerSaveSettings()},L=Object.keys(i).map((function(t,e){var n=x.setElement({tag:"LI",classList:["garland-item"]});return n.setAttribute("style","background: ".concat(i[t])),t===x.pageSettings.garland.color&&n.classList.add("active"),n.onclick=function(){x.pageSettings.garland.isActive||(x.pageSettings.garland.isActive=!0,p(S,!0)),x.pageSettings.garland.color=t,L.forEach((function(t,n){return t.classList.toggle("active",n===e)})),x.triggerUpdateTree(),x.triggerSaveSettings()},n})),m.append(h,v),v.append.apply(v,O(O([],L,!1),[S],!1)),(T=this.setElement({tag:"BUTTON",classList:["reset-settings-button"],innerText:"Сбросить настройки"})).onclick=function(){localStorage.removeItem("userTreePageSettings"),x.popup.draw("LocalStorage очищен! Фон, тип елки, гирлянда, снег и музыка приведены в состояние по умолчанию. Можете перезагрузить страницу")},this.sectionHTML.append(t,r,g,m,T),[2]}}))},new((n=void 0)||(n=Promise))((function(s,r){function o(t){try{l(a.next(t))}catch(t){r(t)}}function i(t){try{l(a.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,i)}l((a=a.apply(t,e||[])).next())}));var t,e,n,a},e}(o),_=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),N=function(t){function e(e,n,a,s,r,o,i,l){var c=t.call(this)||this;return c.currentToysList=e,c.savedTreeStates=n,c.currentToysOnTree=a,c.treeContainer=s,c.treeArea=r,c.sectionHTML=c.setElement({tag:"SECTION",classList:["item-section"]}),c.pageSettings=o,c.triggerUpdateToys=i,c.triggerRebuildPage=l,c}return _(e,t),e.prototype.update=function(){var t=this;this.sectionHTML.innerHTML="";var e=this.setElement({tag:"DIV",classList:["active-toys-container"]}),n=this.setElement({tag:"H2",classList:["active-toys-title"],innerText:"игрушки"}),a=this.setElement({tag:"UL",classList:["active-toys-list"]}),s=this.currentToysList.map((function(e){var n=t.setElement({tag:"LI",classList:["active-toys-item"]}),a=t.setElement({tag:"SPAN",classList:["active-toys-count"],innerText:e.count});return u("https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/toys/".concat(e.num,".avif")).then((function(t){return n.style.backgroundImage="url(".concat(t,")")})),+e.count||n.classList.add("inactive"),n.append(a),n.onmousedown=function(s){s.preventDefault(),e.count=+e.count-1,a.textContent=String(e.count);var r=n.offsetWidth,o=n.offsetHeight,i=t.setElement({tag:"DIV",classList:["toy-on-tree"]});i.style.backgroundImage=n.style.backgroundImage,g(i,s.clientX,s.clientY,r,o),document.body.append(i),document.onmousemove=function(s){g(i,s.clientX,s.clientY,r,o),document.onmouseup=function(s){if(s.target===t.treeArea){+e.count||n.classList.add("inactive");var r=t.treeContainer.getBoundingClientRect(),o={coords:{x:s.clientX-r.left,y:s.clientY-r.top},toy:e,id:"".concat(e.num,"-").concat(e.count)};t.currentToysOnTree.push(o),t.triggerUpdateToys()}else e.count=+e.count+1,a.textContent=String(e.count);i.remove(),document.onmousemove=null,document.onmouseup=null}}},n}));e.append(n,a),a.append.apply(a,s);var r=this.setElement({tag:"DIV",classList:["made-tree-container"]}),o=this.setElement({tag:"H2",classList:["made-tree-title"],innerText:"Вы нарядили"}),i=this.setElement({tag:"UL",classList:["made-tree-list"]}),l=JSON.parse(localStorage.getItem("userSavedStates"));if(l){var c=l.map((function(e){var n=t.setElement({tag:"LI",classList:["made-tree-item"]}),a=e.treePageSettings.treeNum;return u("https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/tree/".concat(a,".avif")).then((function(t){return n.style.backgroundImage="url(".concat(t,")")})),n.onclick=function(){t.triggerRebuildPage(e)},n}));i.append.apply(i,c)}r.append(o,i);var p=this.setElement({tag:"BUTTON",classList:["state-button"],innerText:"Сохранить состояние"});p.onclick=function(){var e={treePageSettings:t.pageSettings,toysList:t.currentToysList,toysOnTree:t.currentToysOnTree};t.savedTreeStates.push(e),localStorage.setItem("userSavedStates",JSON.stringify(t.savedTreeStates)),t.update()};var d=this.setElement({tag:"BUTTON",classList:["state-button"],innerText:"Очистить состояния"});d.onclick=function(){t.savedTreeStates=[],localStorage.setItem("userSavedStates",JSON.stringify(t.savedTreeStates)),t.update()},this.sectionHTML.append(e,r,p,d)},e}(o),A=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),F=function(t){function e(e,n,a,s,r,o){var i,l=t.call(this)||this;l.currentToysOnTree=e,l.currentToysList=a,l.pageSettings=n,l.treeArea=r,l.updateToysSection=o,l.sectionHTML=s,l.treeImage=l.setElement({tag:"IMG",classList:["tree-img"],attributes:[{name:"useMap",value:"#tree-map"}]}),l.snowflakesContainer=l.setElement({tag:"DIV",classList:["snowflakes-container"]}),l.treeMap=l.setElement({tag:"MAP",attributes:[{name:"name",value:"tree-map"}]}),l.garland=l.setElement({tag:"DIV",classList:["garland-tree-container"]});var c=new Array(125).fill(0).map((function(){return l.setElement({tag:"I"})}));return(i=l.snowflakesContainer).append.apply(i,c),l.treeMap.append(l.treeArea),l.sectionHTML.append(l.snowflakesContainer,l.treeMap,l.treeImage,l.garland),l}return A(e,t),e.prototype.updateAll=function(){this.updateBg(),this.updateTree(),this.updateGarland(),this.updateToys(),this.updateSnowfall()},e.prototype.updateBg=function(){var t=this,e="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/bg/".concat(this.pageSettings.bgNum,".avif");u(e).then((function(e){return t.sectionHTML.style.backgroundImage="url(".concat(e,")")}))},e.prototype.updateTree=function(){var t=this,e="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/tree/".concat(this.pageSettings.treeNum,".avif");u(e).then((function(e){t.treeImage.src=e}))},e.prototype.updateGarland=function(){var t;this.garland.innerHTML="",this.pageSettings.garland.isActive&&(this.garland.innerHTML=(t=this.pageSettings.garland.color,'<ul className="lightrope" style="width: 120px; height: 120px;">\n<li class="'.concat(t,'" style="transform: rotate(65deg) translate(60px) rotate(-65deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(77deg) translate(60px) rotate(-77deg);"></li>\n<li class="re').concat(t,'d" style="transform: rotate(89deg) translate(60px) rotate(-89deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(101deg) translate(60px) rotate(-101deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(113deg) translate(60px) rotate(-113deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 170px; height: 170px;">\n<li class="').concat(t,'" style="transform: rotate(60deg) translate(85px) rotate(-60deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(70deg) translate(85px) rotate(-70deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(80deg) translate(85px) rotate(-80deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(90deg) translate(85px) rotate(-90deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(100deg) translate(85px) rotate(-100deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(110deg) translate(85px) rotate(-110deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(120deg) translate(85px) rotate(-120deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 230px; height: 230px;">\n<li class="').concat(t,'" style="transform: rotate(60deg) translate(115px) rotate(-60deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(68deg) translate(115px) rotate(-68deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(76deg) translate(115px) rotate(-76deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(84deg) translate(115px) rotate(-84deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(92deg) translate(115px) rotate(-92deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(100deg) translate(115px) rotate(-100deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(108deg) translate(115px) rotate(-108deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(116deg) translate(115px) rotate(-116deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 300px; height: 300px;">\n<li class="').concat(t,'" style="transform: rotate(60deg) translate(150px) rotate(-60deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(66deg) translate(150px) rotate(-66deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(72deg) translate(150px) rotate(-72deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(78deg) translate(150px) rotate(-78deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(84deg) translate(150px) rotate(-84deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(90deg) translate(150px) rotate(-90deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(96deg) translate(150px) rotate(-96deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(102deg) translate(150px) rotate(-102deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(108deg) translate(150px) rotate(-108deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(114deg) translate(150px) rotate(-114deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(120deg) translate(150px) rotate(-120deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 380px; height: 380px;">\n<li class="').concat(t,'" style="transform: rotate(55deg) translate(190px) rotate(-55deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(59deg) translate(190px) rotate(-59deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(63deg) translate(190px) rotate(-63deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(67deg) translate(190px) rotate(-67deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(71deg) translate(190px) rotate(-71deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(75deg) translate(190px) rotate(-75deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(79deg) translate(190px) rotate(-79deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(83deg) translate(190px) rotate(-83deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(87deg) translate(190px) rotate(-87deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(91deg) translate(190px) rotate(-91deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(95deg) translate(190px) rotate(-95deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(99deg) translate(190px) rotate(-99deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(103deg) translate(190px) rotate(-103deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(107deg) translate(190px) rotate(-107deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(111deg) translate(190px) rotate(-111deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(115deg) translate(190px) rotate(-115deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(119deg) translate(190px) rotate(-119deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(123deg) translate(190px) rotate(-123deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 465px; height: 465px;">\n<li class="').concat(t,'" style="transform: rotate(55deg) translate(232.5px) rotate(-55deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(58.5deg) translate(232.5px) rotate(-58.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(62deg) translate(232.5px) rotate(-62deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(65.5deg) translate(232.5px) rotate(-65.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(69deg) translate(232.5px) rotate(-69deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(72.5deg) translate(232.5px) rotate(-72.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(76deg) translate(232.5px) rotate(-76deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(79.5deg) translate(232.5px) rotate(-79.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(83deg) translate(232.5px) rotate(-83deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(86.5deg) translate(232.5px) rotate(-86.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(90deg) translate(232.5px) rotate(-90deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(93.5deg) translate(232.5px) rotate(-93.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(97deg) translate(232.5px) rotate(-97deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(100.5deg) translate(232.5px) rotate(-100.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(104deg) translate(232.5px) rotate(-104deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(107.5deg) translate(232.5px) rotate(-107.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(111deg) translate(232.5px) rotate(-111deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(114.5deg) translate(232.5px) rotate(-114.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(118deg) translate(232.5px) rotate(-118deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(121.5deg) translate(232.5px) rotate(-121.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(125deg) translate(232.5px) rotate(-125deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 555px; height: 555px;">\n<li class="').concat(t,'" style="transform: rotate(58deg) translate(277.5px) rotate(-58deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(61deg) translate(277.5px) rotate(-61deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(64deg) translate(277.5px) rotate(-64deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(67deg) translate(277.5px) rotate(-67deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(70deg) translate(277.5px) rotate(-70deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(73deg) translate(277.5px) rotate(-73deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(76deg) translate(277.5px) rotate(-76deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(79deg) translate(277.5px) rotate(-79deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(82deg) translate(277.5px) rotate(-82deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(85deg) translate(277.5px) rotate(-85deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(88deg) translate(277.5px) rotate(-88deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(91deg) translate(277.5px) rotate(-91deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(94deg) translate(277.5px) rotate(-94deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(97deg) translate(277.5px) rotate(-97deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(100deg) translate(277.5px) rotate(-100deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(103deg) translate(277.5px) rotate(-103deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(106deg) translate(277.5px) rotate(-106deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(109deg) translate(277.5px) rotate(-109deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(112deg) translate(277.5px) rotate(-112deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(115deg) translate(277.5px) rotate(-115deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(118deg) translate(277.5px) rotate(-118deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(121deg) translate(277.5px) rotate(-121deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(124deg) translate(277.5px) rotate(-124deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(127deg) translate(277.5px) rotate(-127deg);"></li>\n</ul>\n<ul class="lightrope" style="width: 650px; height: 650px;">\n<li class="').concat(t,'" style="transform: rotate(58deg) translate(325px) rotate(-58deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(60.5deg) translate(325px) rotate(-60.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(63deg) translate(325px) rotate(-63deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(65.5deg) translate(325px) rotate(-65.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(68deg) translate(325px) rotate(-68deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(70.5deg) translate(325px) rotate(-70.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(73deg) translate(325px) rotate(-73deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(75.5deg) translate(325px) rotate(-75.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(78deg) translate(325px) rotate(-78deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(80.5deg) translate(325px) rotate(-80.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(83deg) translate(325px) rotate(-83deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(85.5deg) translate(325px) rotate(-85.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(88deg) translate(325px) rotate(-88deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(90.5deg) translate(325px) rotate(-90.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(93deg) translate(325px) rotate(-93deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(95.5deg) translate(325px) rotate(-95.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(98deg) translate(325px) rotate(-98deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(100.5deg) translate(325px) rotate(-100.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(103deg) translate(325px) rotate(-103deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(105.5deg) translate(325px) rotate(-105.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(108deg) translate(325px) rotate(-108deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(110.5deg) translate(325px) rotate(-110.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(113deg) translate(325px) rotate(-113deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(115.5deg) translate(325px) rotate(-115.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(118deg) translate(325px) rotate(-118deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(120.5deg) translate(325px) rotate(-120.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(123deg) translate(325px) rotate(-123deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(125.5deg) translate(325px) rotate(-125.5deg);"></li>\n<li class="').concat(t,'" style="transform: rotate(128deg) translate(325px) rotate(-128deg);"></li>\n</ul>')))},e.prototype.updateToys=function(){var t=this;this.sectionHTML.querySelectorAll(".toy-on-tree").forEach((function(t){return t.remove()})),this.currentToysOnTree.forEach((function(e){var n="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/toys/".concat(e.toy.num,".avif"),a=t.setElement({tag:"DIV",classList:["toy-on-tree"]});u(n).then((function(t){return a.style.backgroundImage="url(".concat(t,")")})),a.classList.add("draggable"),a.onmousedown=function(n){var o=t.sectionHTML.getBoundingClientRect();g(a,n.clientX-o.left,n.clientY-o.top,s,r),document.onmousemove=function(n){a.classList.remove("draggable"),g(a,n.clientX-o.left,n.clientY-o.top,s,r),document.onmouseup=function(n){if(n.target===t.treeArea)e.coords.x=n.clientX-o.left,e.coords.y=n.clientY-o.top;else{var s=t.currentToysList.find((function(t){return t.num===e.toy.num}));s.count=+s.count+1,a.remove();var r=t.currentToysOnTree.indexOf(e);t.currentToysOnTree.splice(r,1),t.updateToysSection()}t.updateToys(),document.onmousemove=null,document.onmouseup=null}}};var s=a.offsetWidth,r=a.offsetHeight;g(a,e.coords.x,e.coords.y,s,r),t.sectionHTML.append(a)}))},e.prototype.updateSnowfall=function(){this.snowflakesContainer.classList.toggle("hide",!this.pageSettings.snowfall)},e}(o),k=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),C=function(t){function e(){var e=t.call(this)||this;return e.footerHTML=e.setElement({tag:"FOOTER",classList:["footer"]}),e}return k(e,t),e.prototype.update=function(){this.footerHTML.innerHTML="";var t=this.setElement({tag:"FOOTER",classList:["footer"]}),e=this.setElement({tag:"A",classList:["rss-logo"],attributes:[{name:"href",value:"https://rs.school/"}]}),n=this.setElement({tag:"DIV",classList:["author-container"]}),a=this.setElement({tag:"SPAN",innerText:"App Developer: IX/CptShell"}),s=this.setElement({tag:"SPAN",innerText:"2021"});t.append(e,n),n.append(a,s)},e}(o),P=function(){function t(t){this.track=new Audio(t),this.tickStopper=!1}return t.prototype.play=function(){var t=this;this.tickStopper=!1,this.track.currentTime=0,this.track.volume=0,this.track.play();var e=setInterval((function(){(t.track.volume>.5||t.tickStopper)&&clearInterval(e),t.track.volume+=5e-4}))},t.prototype.stop=function(){this.tickStopper=!0,this.track.pause()},t}(),H=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),j=function(t){function e(e,n,a,s,r){var o=t.call(this)||this;return o.popup=new v,o.audioPlayer=new P("https://github.com/cptShell/christmas-data/blob/main/assets/audio/audio.mp3?raw=true"),o.toysList=e,o.toysSettings=n,o.currentToysList=s||function(t,e){return e.length?e.reduce((function(e,n){var a=t.find((function(t){return+t.num==+n}));return e.push(a),e}),[]):t.slice(0,20)}(o.toysList,o.toysSettings.choosedIdList),o.currentToysOnTree=a||[],o.pageSettings=r||JSON.parse(localStorage.getItem("userPageSettings"))||E,o.savedTreeStates=JSON.parse(localStorage.getItem("userSavedStates"))||[],o.footer=new C,o.treeContainer=o.setElement({tag:"SECTION",classList:["tree-section"]}),o.treeArea=o.setElement({tag:"AREA",attributes:[{name:"shape",value:"poly"}]}),o.treeArea.setAttribute("coords","365,699,189,706,113,683,31,608,2,555,2,539,18,437,73,351,106,224,161,134,243,-1,306,75,353,144,399,221,424,359,452,459,496,550,444,664"),o.settingsSection=new I(o.pageSettings,o.treeSectionUpdater.bind(o),o.toggleMusic.bind(o),o.toggleSnowFall.bind(o,"updateSnowfall"),o.savePageSettings.bind(o),o.popup),o.itemSection=new N(o.currentToysList,o.savedTreeStates,o.currentToysOnTree,o.treeContainer,o.treeArea,o.pageSettings,o.treeSectionUpdater.bind(o,"updateToys"),o.rebuild.bind(o)),o.treeSection=new F(o.currentToysOnTree,o.pageSettings,o.currentToysList,o.treeContainer,o.treeArea,o.updateItemSection.bind(o)),o}return H(e,t),e.prototype.draw=function(){var t=this,e=this.setElement({tag:"HEADER",classList:["header"]}),n=this.setElement({tag:"UL",classList:["nav-list"]}),a=this.setElement({tag:"LI",classList:["nav-button","icon"]});a.onclick=function(){t.destroy(),new R(t.toysList,t.toysSettings).draw()};var s=this.setElement({tag:"LI",classList:["nav-item"]}),r=this.setElement({tag:"BUTTON",classList:["nav-button"],innerText:"игрушки"});r.onclick=function(){t.destroy(),new U(t.toysList,t.toysSettings).draw()},s.append(r);var o=this.setElement({tag:"LI",classList:["nav-item"]}),i=this.setElement({tag:"BUTTON",classList:["nav-button"],innerText:"ёлка"});o.append(i),e.append(n),n.append(a,s,o);var l=this.setElement({tag:"MAIN",classList:["tree-page"]});this.settingsSection.update(),this.treeSection.updateAll(),this.itemSection.update(),this.footer.update(),document.body.innerHTML="",l.append(this.settingsSection.sectionHTML,this.treeSection.sectionHTML,this.itemSection.sectionHTML),document.body.append(e,l,this.footer.footerHTML),this.toggleMusic()},e.prototype.destroy=function(){this.audioPlayer.stop(),document.body.innerHTML=""},e.prototype.treeSectionUpdater=function(t){void 0===t&&(t="updateAll"),this.treeSection[t]()},e.prototype.toggleMusic=function(){this.pageSettings.volume?this.audioPlayer.play():this.audioPlayer.stop()},e.prototype.toggleSnowFall=function(){this.treeSection.updateSnowfall()},e.prototype.updateItemSection=function(){this.itemSection.update()},e.prototype.savePageSettings=function(){localStorage.setItem("userPageSettings",JSON.stringify(this.pageSettings))},e.prototype.rebuild=function(t){this.destroy(),new e(this.toysList,this.toysSettings,t.toysOnTree,t.toysList,t.treePageSettings).draw()},e}(o),M=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),U=function(t){function e(e,n){var a=t.call(this)||this;return a.toysList=e,a.toysSettings=n,a.searchValue="",a.valueFilterSection=new f(a.toysSettings.valueFilters,a.updateToys.bind(a)),a.rangeFilterSection=new m(a.toysSettings.rangeFilters,a.updateToys.bind(a)),a.sortSection=new x(a.toysSettings,a.updateToys.bind(a),a.resetSettings.bind(a),a.resetLocalStorage.bind(a)),a.toysSection=new L(a.toysList,a.toysSettings.choosedIdList,a.updateChoosedIdList.bind(a),a.toogleSaveState.bind(a)),a.toysPopup=new v,a.choosedToysDisplay=a.setElement({tag:"DIV",classList:["search-found"]}),a}return M(e,t),Object.defineProperty(e.prototype,"selectedToysCount",{get:function(){return String(this.toysSettings.choosedIdList.length)},enumerable:!1,configurable:!0}),e.prototype.draw=function(){var t=this,e=this.setElement({tag:"HEADER",classList:["header"]}),n=this.setElement({tag:"UL",classList:["nav-list"]}),a=this.setElement({tag:"LI",classList:["nav-button","icon"]});a.onclick=function(){t.destoy(),new R(t.toysList,t.toysSettings).draw()};var s=this.setElement({tag:"LI",classList:["nav-item"]}),r=this.setElement({tag:"BUTTON",classList:["nav-button"],innerText:"игрушки"});s.append(r);var o=this.setElement({tag:"LI",classList:["nav-item"]}),i=this.setElement({tag:"BUTTON",classList:["nav-button"],innerText:"ёлка"});o.onclick=function(){t.destoy(),new j(t.toysList,t.toysSettings).draw()},o.append(i);var l=this.setElement({tag:"DIV",classList:["search-container"]}),c=this.setElement({tag:"BUTTON",classList:["reset-input-button"]}),u=this.setElement({tag:"DIV",classList:["search-input-wrapper"]}),p=this.setElement({tag:"INPUT",classList:["search-input"],innerText:null,attributes:[{name:"type",value:"text"},{name:"placeholder",value:"Поиск"}]});p.oninput=function(){t.searchValue=p.value},p.onkeyup=function(e){var n=p.value===t.searchValue;13===e.keyCode&&n&&(t.searchValue=e.target.value,t.toysSection.update(t.toysSettings,t.searchValue,!0))},c.onclick=function(){p.value="",t.searchValue="",t.updateToys()},this.updateChoosedIdList(),e.append(n,l),n.append(a,s,o),l.append(u,this.choosedToysDisplay),u.append(c,p);var g=this.setElement({tag:"FOOTER",classList:["footer"]}),d=this.setElement({tag:"A",classList:["rss-logo"],attributes:[{name:"href",value:"https://rs.school/"}]}),f=this.setElement({tag:"DIV",classList:["author-container"]}),y=this.setElement({tag:"SPAN",innerText:"App Developer: IX/CptShell"}),m=this.setElement({tag:"SPAN",innerText:"2021"});g.append(d,f),f.append(y,m);var h=this.setElement({tag:"MAIN",classList:["toys-section"]});this.valueFilterSection.update(),this.rangeFilterSection.update();var v=this.sortSection.build(),S=this.toysSection.build();this.updateToys(),h.append(this.valueFilterSection.sectionHTML,this.rangeFilterSection.sectionHTML,v,S),document.body.append(e,h,g),this.toogleSaveState(!0),p.focus(),window.onload=function(){t.toysPopup.draw("Вы можете искать игрушки по введенному тексту\n\n        Для этого просто введите то, что хотите найти и нажмите Enter")}},e.prototype.toogleSaveState=function(t){var e=this;void 0===t&&(t=!0),window.onbeforeunload=t?function(){return localStorage.setItem("userToysSettings",JSON.stringify(e.toysSettings))}:function(){return null}},e.prototype.updateChoosedIdList=function(){this.choosedToysDisplay.textContent=this.selectedToysCount},e.prototype.updateToys=function(){this.toysSection.update(this.toysSettings,this.searchValue)},e.prototype.resetSettings=function(){var t=this;Object.keys(this.toysSettings.valueFilters.choosedForms).forEach((function(e){t.toysSettings.valueFilters.choosedForms[e]=!1})),Object.keys(this.toysSettings.valueFilters.choosedColors).forEach((function(e){t.toysSettings.valueFilters.choosedColors[e]=!1})),Object.keys(this.toysSettings.valueFilters.choosedSizes).forEach((function(e){t.toysSettings.valueFilters.choosedSizes[e]=!1})),this.toysSettings.valueFilters.onlyFavorites=!1,this.toysSettings.rangeFilters.countRange=[0,12],this.toysSettings.rangeFilters.yearRange=[1940,2020],this.valueFilterSection.update(),this.rangeFilterSection.update(),this.updateToys()},e.prototype.resetLocalStorage=function(){this.resetSettings(),this.toogleSaveState(!1),this.toysSettings.choosedIdList=[],this.updateChoosedIdList(),localStorage.removeItem("userToysSettings"),this.toysPopup.draw("Сохраненные настройки сброшены, LocalStorage очищен")},e.prototype.destoy=function(){document.body.innerHTML=""},e}(o),D=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),R=function(t){function e(e,n){var a=t.call(this)||this;return a.settings=n,a.toysList=e,a.popup=new v,a}return D(e,t),e.prototype.draw=function(){var t=this;this.popup.draw("Не забудь чекнуть консоль браузера, там найдешь самооценку. Удачного кроссчека :3"),document.body.innerHTML="";var e=this.setElement({tag:"HEADER",classList:["header"]}),n=this.setElement({tag:"UL",classList:["nav-list"]}),a=this.setElement({tag:"LI",classList:["nav-button","icon"]}),s=this.setElement({tag:"LI",classList:["nav-item"]}),r=this.setElement({tag:"BUTTON",classList:["nav-button"],innerText:"игрушки"});r.onclick=function(){t.destroy(),new U(t.toysList,t.settings).draw()},s.append(r);var o=this.setElement({tag:"LI",classList:["nav-item"]}),i=this.setElement({tag:"BUTTON",classList:["nav-button"],innerText:"ёлка"});i.onclick=function(){t.destroy(),new j(t.toysList,t.settings).draw()},o.append(i),e.append(n),n.append(a,s,o);var l=this.setElement({tag:"MAIN",classList:["start-main"]}),c=this.setElement({tag:"H1",innerText:"Помогите бабушке \n нарядить елку"}),u=this.setElement({tag:"BUTTON",classList:["start-button"],innerText:"Начать"});l.append(c,u),u.onclick=function(){t.destroy(),new U(t.toysList,t.settings).draw()};var p=this.setElement({tag:"FOOTER",classList:["footer"]}),g=this.setElement({tag:"A",classList:["rss-logo"],attributes:[{name:"href",value:"https://rs.school/"}]}),d=this.setElement({tag:"DIV",classList:["author-container"]}),f=this.setElement({tag:"SPAN",innerText:"App Developer: IX/CptShell"}),y=this.setElement({tag:"SPAN",innerText:"2021"});p.append(g,d),d.append(f,y),document.body.append(e,l,p)},e.prototype.destroy=function(){document.body.innerHTML=""},e}(o);(new(function(){function t(){}return t.prototype.init=function(){fetch("https://raw.githubusercontent.com/cptShell/christmas-data/main/data.json").then((function(t){return t.json()})).then((function(t){var e=JSON.parse(localStorage.getItem("userToysSettings"))||b;new R(t,e).draw()}))},t}())).init(),console.log('\n  Краткая самооценка:\n  1) Со всех страниц можно перейти на остальный, верстка не огонь конечно, но и не ужасно. +30\n  2) Можно сменить 10 фонов, 6 елок, снег, музыку и гирлянду, а также все это хранится в localStorage +50\n  3) Гирлянда практически 1 в 1 скопирована с демки, тут ничего не улучшить/ухудшить, просто сделал, чтобы это работало. Цвета меняются, туглер работает как в демо +40\n  4) Игрушки отображаются, в случае 0 выбранных вы получите первые 20, сраный drag and drop работает, если игрушка опускаетя вне пределов, то вернется назад, в пределах елки перемещать тоже можно, снять с елки тоже можно, слоты игрушек с каунтерами также корректно считаются +80\n  5) Я не знал, что это допа, но смог реализовать полное сохранение стейта в секции "Вы нарядили". Надо было тз лучше читать, меньше бы сделал, но так даже лучше) +10\n  Как маленькую допу я хотел продвинуть специальный класс попапов, которые в зависимости от страницы и типа события показывает разные сообщения, поясняя разные действия пользователя. Эта штука не особо сложная, но полезная и легко переиспользуема. Прошу +5 за это\n\n  Итого 215/200, чтобы на этот раз хватило с запасом\n\n  Пишите свой фидбек и замечания, пожалуйста, их ведь можно поправить и работа станет чуть лучше. Заранее спасибо\n')})();
//# sourceMappingURL=main.js.map