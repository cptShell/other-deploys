(()=>{"use strict";var t,e,n,s,i,a,r=function(){function t(){}return t.prototype.setElement=function(t){var e,n=t.tag,s=t.classList,i=void 0===s?void 0:s,a=t.innerText,r=void 0===a?void 0:a,o=t.attributes,l=void 0===o?void 0:o,c=document.createElement(n);return i&&(e=c.classList).add.apply(e,i),r&&(c.textContent=String(r)),l&&l.forEach((function(t){return c.setAttribute(t.name,t.value)})),c},t}();!function(t){t.white="#ffffff",t.yellow="#fdd700",t.red="#fd0000",t.blue="#2299eb",t.green="#08aa05"}(t||(t={})),function(t){t.sortByNameUp='По названию от "А" до "Я"',t.sortByNameDown='По названию от "Я" до "А"',t.sortByYearUp="По году от 1940 до 2020",t.sortByYearDown="По году от 2020 до 1940"}(e||(e={})),function(t){t.count="Количество",t.year="Год покупки",t.shape="Форма",t.color="Цвет",t.size="Размер",t.favorite="Любимая"}(n||(n={})),function(t){t["шар"]="ball",t["колокольчик"]="bell",t["шишка"]="cone",t["снежинка"]="snowflake",t["фигурка"]="toy"}(s||(s={})),function(t){t["белый"]="white",t["желтый"]="yellow",t["красный"]="red",t["синий"]="blue",t["зелёный"]="green"}(i||(i={})),function(t){t["большой"]="big",t["средний"]="medium",t["малый"]="small"}(a||(a={}));var o,l=function(t,e){return String(t.filter((function(t){return t[0]===e}))[0][1])},c=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(e){function n(t,n){var s=e.call(this)||this;return s.valueFilter=t,s.updateTrigger=n,s.sectionHTML=s.setElement({tag:"SECTION",classList:["value-filter"]}),s}return c(n,e),n.prototype.update=function(){var e=this,n=Object.entries(this.valueFilter.choosedForms),s=Object.entries(this.valueFilter.choosedColors),i=Object.entries(this.valueFilter.choosedSizes),a=this.setElement({tag:"H2",classList:["value-title"],innerText:"фильтры по значению"}),r=this.setElement({tag:"UL",classList:["value-list"]}),o=this.setElement({tag:"LI",classList:["value-item"]}),c=this.setElement({tag:"H3",classList:["toyform-subtitle"],innerText:"Форма:"}),u=this.setElement({tag:"UL",classList:["toyform-list"]}),p=new Array(Object.keys(this.valueFilter.choosedForms).length).fill(null).map((function(t,s){var i=n[s][0],a=e.setElement({tag:"LI",classList:["toyform-item","toyform-"+i]});return e.valueFilter.choosedForms[i]&&a.classList.add("active"),a.onclick=function(){var t=e.valueFilter.choosedForms[i];e.valueFilter.choosedForms[i]=!t,a.classList.toggle("active"),e.updateTrigger()},a}));o.append(c,u),u.append.apply(u,p);var g=this.setElement({tag:"LI",classList:["value-item"]}),h=this.setElement({tag:"H3",classList:["color-subtitle"],innerText:"Цвет:"}),y=this.setElement({tag:"UL",classList:["color-list"]}),f=new Array(Object.keys(this.valueFilter.choosedColors).length).fill(null).map((function(n,i){var a=s[i][0],r=e.setElement({tag:"LI",classList:["color-item"],attributes:[{name:"style",value:"background-color:".concat(l(Object.entries(t),a))}]});return e.valueFilter.choosedColors[a]&&r.classList.add("active"),r.onclick=function(){var t=e.valueFilter.choosedColors[a];e.valueFilter.choosedColors[a]=!t,r.classList.toggle("active"),e.updateTrigger()},r}));g.append(h,y),y.append.apply(y,f);var v=["big","medium","small"],d=this.setElement({tag:"LI",classList:["value-item"]}),m=this.setElement({tag:"H3",classList:["size-subtitle"],innerText:"Размер:"}),S=this.setElement({tag:"UL",classList:["size-list"]}),L=new Array(Object.keys(this.valueFilter.choosedSizes).length).fill(null).map((function(t,n){var s=e.setElement({tag:"LI",classList:["size-item",v[n]]}),a=i[n][0];return e.valueFilter.choosedSizes[a]&&s.classList.add("active"),s.onclick=function(){var t=e.valueFilter.choosedSizes[a];e.valueFilter.choosedSizes[a]=!t,s.classList.toggle("active"),e.updateTrigger()},s}));d.append(m,S),S.append.apply(S,L);var b=this.setElement({tag:"LI",classList:["value-item"]}),E=this.setElement({tag:"H3",classList:["favorites-subtitle"],innerText:"Только любимые"}),T=this.setElement({tag:"DIV",classList:["favorites-checkbox"]});this.valueFilter.onlyFavorites&&T.classList.add("active"),T.onclick=function(){var t=e.valueFilter.onlyFavorites;e.valueFilter.onlyFavorites=!t,T.classList.toggle("active"),e.updateTrigger()},b.append(E,T),r.append(o,g,d,b),this.sectionHTML.innerHTML="",this.sectionHTML.append(a,r)},n}(r),p=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),g=function(t){function e(e,n){var s=t.call(this)||this;return s.parentSettings=e,s.updateTrigger=n,s.sectionHTML=s.setElement({tag:"SECTION",classList:["range-section"]}),s}return p(e,t),e.prototype.update=function(){var t=this,e=this.setElement({tag:"H2",classList:["range-title"],innerText:"фильтры по диапазону"}),n=this.setElement({tag:"DIV",classList:["range-container"]}),s=this.setElement({tag:"DIV",classList:["count-container"]}),i=this.setElement({tag:"H3",classList:["count-subtitle"],innerText:"Количество экземпляров"}),a=this.setElement({tag:"DIV",classList:["count-label"]}),r=this.setElement({tag:"SPAN",classList:["count-min"],innerText:String(this.parentSettings.countRange[0])}),o=this.setElement({tag:"SPAN",classList:["count-max"],innerText:String(this.parentSettings.countRange[1])}),l=this.setElement({tag:"DIV",classList:["count-input-container"]}),c=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1)},{name:"max",value:String(12)},{name:"step",value:String(1)},{name:"value",value:String(this.parentSettings.countRange[0])}]}),u=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1)},{name:"max",value:String(12)},{name:"step",value:String(1)},{name:"value",value:String(this.parentSettings.countRange[1])}]});c.addEventListener("input",(function(){+c.value>+u.value&&(u.value=c.value),t.parentSettings.countRange[0]=Number(c.value),t.parentSettings.countRange[1]=Number(u.value),r.textContent=String(t.parentSettings.countRange[0]),o.textContent=String(t.parentSettings.countRange[1])})),u.addEventListener("input",(function(){+u.value<+c.value&&(c.value=u.value),t.parentSettings.countRange[0]=Number(c.value),t.parentSettings.countRange[1]=Number(u.value),r.textContent=String(t.parentSettings.countRange[0]),o.textContent=String(t.parentSettings.countRange[1])})),l.append(c,u),s.append(i,a),a.append(r,l,o);var p=this.setElement({tag:"DIV",classList:["year-container"]}),g=this.setElement({tag:"H3",classList:["year-subtitle"],innerText:"Год приобретения:"}),h=this.setElement({tag:"DIV",classList:["year-label"]}),y=this.setElement({tag:"SPAN",classList:["year-min"],innerText:String(this.parentSettings.yearRange[0])}),f=this.setElement({tag:"SPAN",classList:["year-max"],innerText:String(this.parentSettings.yearRange[1])}),v=this.setElement({tag:"DIV",classList:["year-input-container"]}),d=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1940)},{name:"max",value:String(2020)},{name:"step",value:String(10)},{name:"value",value:String(this.parentSettings.yearRange[0])}]}),m=this.setElement({tag:"INPUT",classList:["year-input"],attributes:[{name:"type",value:"range"},{name:"min",value:String(1940)},{name:"max",value:String(2020)},{name:"step",value:String(10)},{name:"value",value:String(this.parentSettings.yearRange[1])}]});d.addEventListener("input",(function(){+d.value>+m.value&&(m.value=d.value),t.parentSettings.yearRange[0]=Number(d.value),t.parentSettings.yearRange[1]=Number(m.value),y.textContent=String(t.parentSettings.yearRange[0]),f.textContent=String(t.parentSettings.yearRange[1])})),m.addEventListener("input",(function(){+m.value<+d.value&&(d.value=m.value),t.parentSettings.yearRange[0]=Number(d.value),t.parentSettings.yearRange[1]=Number(m.value),y.textContent=String(t.parentSettings.yearRange[0]),f.textContent=String(t.parentSettings.yearRange[1])})),[d,m,c,u].forEach((function(e){return e.onchange=function(){return t.updateTrigger()}})),v.append(d,m),p.append(g,h),h.append(y,v,f),n.append(s,p),this.sectionHTML.innerHTML="",this.sectionHTML.append(e,n)},e}(r),h=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),y=function(t){function e(){var e=t.call(this)||this;return e.wrapper=e.setElement({tag:"DIV",classList:["popup-wrapper"]}),e.element=e.setElement({tag:"DIV",classList:["popup"]}),e.wrapper.append(e.element),e.isActive=!1,e}return h(e,t),e.prototype.draw=function(t){var e=this;this.isActive||(this.isActive=!0,this.element.textContent=t,document.body.append(this.wrapper),this.wrapper.animate([{opacity:0},{opacity:1}],{duration:250,easing:"ease"}).onfinish=function(){e.wrapper.classList.add("active"),e.element.animate([{transform:"translateY(-200px)",opacity:0},{transform:"translateY(0)",opacity:1}],{duration:250,easing:"ease"}).onfinish=function(){e.element.classList.add("active"),e.wrapper.onclick=function(){e.destroy(),e.wrapper.onclick=null},document.onkeyup=function(t){13===t.keyCode&&e.destroy(),document.onkeyup=null}}})},e.prototype.destroy=function(){var t=this;this.element.animate([{transform:"translateY(0)",opacity:1},{transform:"translateY(-200px)",opacity:0}],{duration:250,easing:"ease"}).onfinish=function(){t.element.classList.remove("active"),t.wrapper.animate([{opacity:1},{opacity:0}],{duration:250,easing:"ease"}).onfinish=function(){t.element.classList.remove("active"),t.wrapper.remove(),t.isActive=!1}}},e}(r),f=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),v=function(t){function e(e,n,s){var i=t.call(this)||this;return i.toysList=e,i.toysContainer=i.setElement({tag:"SECTION",classList:["toys"]}),i.toysIdList=n,i.triggerUpdateIdList=s,i.popup=new y,i}return f(e,t),e.prototype.update=function(t,e,r){var o,c=this;void 0===r&&(r=!1);var u=function(t){return Boolean(Object.values(t).includes(!0))},p=Object.entries(n),g=function(t,e,n){if(n||2===arguments.length)for(var s,i=0,a=e.length;i<a;i++)!s&&i in e||(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}([],this.toysList,!0);g=(g=(g=g.filter((function(e){if(u(t.valueFilters.choosedForms)){var n=Object.entries(t.valueFilters.choosedForms).filter((function(t){return t[1]})),i=l(Object.entries(s),e.shape);return Boolean(n.find((function(t){return t[0]===i})))}return!0}))).filter((function(e){if(u(t.valueFilters.choosedColors)){var n=Object.entries(t.valueFilters.choosedColors).filter((function(t){return t[1]})),s=l(Object.entries(i),e.color);return Boolean(n.find((function(t){return t[0]===s})))}return!0}))).filter((function(e){if(u(t.valueFilters.choosedSizes)){var n=Object.entries(t.valueFilters.choosedSizes).filter((function(t){return t[1]})),s=l(Object.entries(a),e.size);return Boolean(n.find((function(t){return t[0]===s})))}return!0})),t.valueFilters.onlyFavorites&&(g=g.filter((function(t){return t.favorite}))),(g=g.filter((function(e){return[[t.rangeFilters.countRange[0],+e.count,t.rangeFilters.countRange[1]],[t.rangeFilters.yearRange[0],+e.year,t.rangeFilters.yearRange[1]]].every((function(t){return t.every((function(e,n){return!(n<t.length-1)||e<=t[n+1]}))}))}))).sort((function(e,n){switch(t.choosedSortKey){case"sortByNameUp":return e.name<n.name?-1:1;case"sortByNameDown":return e.name>n.name?-1:1;case"sortByYearUp":return Number(e.year)-Number(n.year);case"sortByYearDown":return Number(n.year)-Number(e.year)}}));var h=(g=g.filter((function(t){var n=e.toUpperCase();return t.name.toUpperCase().includes(n)}))).map((function(t){var e="https://raw.githubusercontent.com/cptShell/christmas-data/main/assets/toys/".concat(t.num,".avif"),n=c.setElement({tag:"DIV",classList:["toy"]});c.toysIdList.includes(Number(t.num))&&n.classList.add("active"),n.onclick=function(){var e=Number(t.num);if(c.toysIdList.includes(e)){var s=c.toysIdList.indexOf(e);c.toysIdList.splice(s,1)}else{if(c.toysIdList.length>=20)return void c.popup.draw("Вы не можете выбрать более 20 игрушек!!!");c.toysIdList.push(e)}n.classList.toggle("active"),c.triggerUpdateIdList()};var s=c.setElement({tag:"H3",classList:["toy-title"],innerText:t.name}),i=c.setElement({tag:"DIV",classList:["toy-content"]}),a=c.setElement({tag:"DIV",classList:["img-container"]}),r=c.setElement({tag:"IMG",classList:["toy-image"],attributes:[{name:"src",value:e},{name:"alt",value:t.name}]}),o=c.setElement({tag:"BUTTON",classList:["toy-favorite"]}),l=c.setElement({tag:"UL",classList:["description-list"]}),u=new Array(p.length).fill(0).map((function(e,n){var s=p[n][0],i=t[s],a=p[n][1]+": "+("boolean"!=typeof i?String(i):i?"да":"нет");return c.setElement({tag:"LI",classList:["description-item"],innerText:a})}));return n.append(s,i),i.append(a,l),a.append(r,o),l.append.apply(l,u),n}));r&&!h.length?this.popup.draw("Не найдено ни одного совпадения по введенным данным среди отфильтрованных игрушек!!!"):(this.toysContainer.innerHTML="",(o=this.toysContainer).append.apply(o,h))},e.prototype.build=function(){var t=this.setElement({tag:"SECTION",classList:["toys-container"]});return t.append(this.toysContainer),t},e}(r),d=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),m=function(t){function n(e,n,s){var i=t.call(this)||this;return i.parentSettings=e,i.updateTrigger=n,i.resetTrigger=s,i}return d(n,t),n.prototype.build=function(){var t=this,n=Object.entries(e),s=this.setElement({tag:"SECTION",classList:["sort-section"]}),i=this.setElement({tag:"H2",classList:["sort-title"],innerText:"Сортировка:"}),a=this.setElement({tag:"DIV",classList:["sort-container"]}),r=this.setElement({tag:"SELECT",classList:["sort-select"],attributes:[{name:"name",value:"sort"}]});r.onchange=function(e){t.parentSettings.choosedSortKey=e.target.value,t.updateTrigger()};var o=new Array(n.length).fill(0).map((function(e,s){var i=t.setElement({tag:"OPTION",classList:["sort-option"],innerText:n[s][1],attributes:[{name:"value",value:n[s][0]}]});return n[s][0]===t.parentSettings.choosedSortKey&&i.setAttribute("selected","selected"),i})),l=this.setElement({tag:"BUTTON",classList:["reset-button"],innerText:"Сброс фильтров"});return l.onclick=function(){t.resetTrigger()},s.append(i,a),a.append(r,l),r.append.apply(r,o),s},n}(r),S=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),L=function(t){function e(e,n){var s=t.call(this)||this;return s.toysSettings=n,s.searchValue="",s.valueFilterSection=new u(s.toysSettings.valueFilters,s.updateToys.bind(s)),s.rangeFilterSection=new g(s.toysSettings.rangeFilters,s.updateToys.bind(s)),s.sortSection=new m(s.toysSettings,s.updateToys.bind(s),s.resetSettings.bind(s)),s.toysSection=new v(e,s.toysSettings.choosedIdList,s.updateChoosedIdList.bind(s)),s.choosedToysDisplay=s.setElement({tag:"DIV",classList:["search-found"]}),s}return S(e,t),Object.defineProperty(e.prototype,"selectedToysCount",{get:function(){return String(this.toysSettings.choosedIdList.length)},enumerable:!1,configurable:!0}),e.prototype.draw=function(){var t=this,e=this.setElement({tag:"HEADER",classList:["header"]}),n=this.setElement({tag:"UL",classList:["nav-list"]}),s=[void 0,"игрушки","ёлка"].map((function(e,n){var s=t.setElement({tag:"LI",classList:["nav-item"]}),i=n?["nav-button"]:["nav-button","icon"],a=t.setElement({tag:"BUTTON",classList:i,innerText:e});return s.append(a),s})),i=this.setElement({tag:"DIV",classList:["search-container"]}),a=this.setElement({tag:"BUTTON",classList:["reset-input-button"]}),r=this.setElement({tag:"DIV",classList:["search-input-wrapper"]}),o=this.setElement({tag:"INPUT",classList:["search-input"],innerText:null,attributes:[{name:"type",value:"text"},{name:"placeholder",value:"Поиск"}]});o.oninput=function(){t.searchValue=o.value},o.onkeyup=function(e){var n=o.value===t.searchValue;console.log(o.value,t.searchValue),13===e.keyCode&&n&&(t.searchValue=e.target.value,t.toysSection.update(t.toysSettings,t.searchValue,!0))},a.onclick=function(){o.value="",t.searchValue="",t.updateToys()},this.updateChoosedIdList(),e.append(n,i),n.append.apply(n,s),i.append(r,this.choosedToysDisplay),r.append(a,o);var l=this.setElement({tag:"FOOTER",classList:["footer"]}),c=this.setElement({tag:"A",classList:["rss-logo"],attributes:[{name:"href",value:"https://rs.school/"}]}),u=this.setElement({tag:"DIV",classList:["author-container"]}),p=this.setElement({tag:"SPAN",innerText:"App Developer: IX/CptShell"}),g=this.setElement({tag:"SPAN",innerText:"2021"});l.append(c,u),u.append(p,g);var h=this.setElement({tag:"MAIN",classList:["toys-section"]});this.valueFilterSection.update(),this.rangeFilterSection.update();var y=this.sortSection.build(),f=this.toysSection.build();this.updateToys(),h.append(this.valueFilterSection.sectionHTML,this.rangeFilterSection.sectionHTML,y,f),document.body.append(e,h,l),window.onbeforeunload=function(){return localStorage.setItem("userToysSettings",JSON.stringify(t.toysSettings))},o.focus()},e.prototype.updateChoosedIdList=function(){this.choosedToysDisplay.textContent=this.selectedToysCount},e.prototype.updateToys=function(){this.toysSection.update(this.toysSettings,this.searchValue)},e.prototype.resetSettings=function(){var t=this;Object.keys(this.toysSettings.valueFilters.choosedForms).forEach((function(e){t.toysSettings.valueFilters.choosedForms[e]=!1})),Object.keys(this.toysSettings.valueFilters.choosedColors).forEach((function(e){t.toysSettings.valueFilters.choosedColors[e]=!1})),Object.keys(this.toysSettings.valueFilters.choosedSizes).forEach((function(e){t.toysSettings.valueFilters.choosedSizes[e]=!1})),this.toysSettings.valueFilters.onlyFavorites=!1,this.toysSettings.rangeFilters.countRange=[0,12],this.toysSettings.rangeFilters.yearRange=[1940,2020],this.valueFilterSection.update(),this.rangeFilterSection.update(),this.updateToys()},e}(r);const b={valueFilters:{choosedForms:{ball:!1,bell:!1,cone:!1,snowflake:!1,toy:!1},choosedColors:{white:!1,yellow:!1,red:!1,blue:!1,green:!1},choosedSizes:{big:!1,medium:!1,small:!1},onlyFavorites:!1},rangeFilters:{countRange:[0,12],yearRange:[1940,2020]},choosedSortKey:"sortByNameUp",choosedIdList:[]};var E=function(){function t(t){var e=JSON.parse(localStorage.getItem("userToysSettings"))||b;this.toys=new L(t,e)}return t.prototype.init=function(){this.toys.draw()},t}();fetch("https://raw.githubusercontent.com/cptShell/christmas-data/main/data.json").then((function(t){return t.json()})).then((function(t){new E(t).init()}))})();
//# sourceMappingURL=main.js.map